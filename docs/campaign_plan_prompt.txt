### Task
Your task is to act as a **Senior Google Ads Strategist**. You will design a highly effective, performance-oriented Google Ads campaign structure based on the provided inputs and return the result strictly as a JSON object.

---

### Objectives

- Design a clear, consolidated campaign structure suitable for:
    - Driving high-intent traffic (Sales/Leads).
    - Maximizing budget efficiency using modern bidding strategies.
    - delivering relevant, conversion-oriented ad copy.
- Adhere strictly to the "Hagakure" (consolidated) structure where possible to maximize data for machine learning.

---

### Inputs

Use the following inputs:

- Website: {{website}}
- Goal: {{goal}}
- Location (country): {{location}}
- State / Area focus: {{state_list}}
- Language: {{language}}
- Monthly Budget (MYR): {{monthly_budget}}

### Keywords Data
{{keyword_data}}

**Keywords Data Format & Usage:**
- **Format:** CSV rows: `keyword, avg_monthly_searches, cpc`.
- **Usage:** Use `avg_monthly_searches` to gauge demand and `cpc` to estimate budget impact. Prioritize keywords with a good balance of volume and cost efficiency when populating Ad Groups.

### Business Context
{{context}}

---

### Knowledge Base: Google Ads Best Practices

To ensure high performance, apply these strategic principles:

1.  **Campaign Type Selection Guide:**
    *   **Search:** Use as the Default for all Lead Generation, Services, B2B, and High-Intent goals.
    *   **PMax:** Use Only if the business has Physical Locations (for Store Visits) or sells products online (E-commerce).
    *   **Demand Gen / Display:** Use Only if the goal is explicitly "Brand Awareness" or "Visual Reach".

2.  **Campaign Structure (Intent-Based):**
    *   **Consolidation:** Avoid hyper-segmentation (SKAGs). Use fewer campaigns with broader, intent-matched Ad Groups.
    *   **Categorization:** Split campaigns by high-level **Category** (e.g., "Men's Shoes" vs "Women's Shoes").
    *   **Ad Groups:** Split by **Sub-Category + User Intent**.
        *   *High Intent:* Transactional keywords ("buy", "price", "service near me"). High bids.
        *   *Mid Intent:* Comparison/Specific keywords ("best running shoes", "leather sofa specs").
        *   *Low Intent:* Informational ("how to clean shoes"). Lower bids or excluded initially.

3.  **Bidding Strategy (The "Cold Start" Framework):**
    *   **Phase 1 (Launch):** New campaigns lack conversion data. Use `Maximize Clicks` with a `MaxCPC_Cap` to drive traffic without overspending on single clicks.
    *   **Phase 2 (Scale):** Once ~15 conversions are recorded, switch to Smart Bidding (`Target CPA` or `Maximize Conversions`).

4.  **Ad Copy (RSAs):**
    *   **Headlines:** Must be distinct.
        *   *Pos 1-3:* Keywords & Direct Benefits.
        *   *Pos 4-7:* Call to Actions (CTAs), Social Proof ("Trusted by 500+"), Urgency, Handling Objections.
    *   **Descriptions:** One description should focus on the USP (Unique Selling Proposition), the other on a strong CTA.

---

### Output Logic & Schema Rules

You must output a single JSON object strictly adhering to the provided schema. Follow these specific rules for each key:

1.  **Campaigns Array**:
    *   Limit to 1-3 highly relevant campaigns to consolidate budget.
    *   **CampaignName**: STRICT FORMAT: `LT-A | [Index] | [YYYYMM] | [Goal] | [Type] | [Geo] | [Language] | [Category]`.
        *   *Index*: 2-digit sequential number (e.g., `01`, `02`).
        *   *Goal*: Shortened goal name (e.g., `Lead`, `Sales`).
        *   *Geo*: ISO Code (e.g., `MY`, `SG`).
        *   *Language*: Primary ISO Code (e.g., `EN` or `EN-MS`).
        *   *Category*: High-level vertical (e.g., `Furniture`, `Dental`).
    *   **Language**:
        *   **Logic**: Determine the languages array based on Brand Positioning.
        *   **Mass Market / Local**: Use `["en", "ms"]`. (Most Malaysians use Malay/English interface settings).
        *   **Premium / International / Expat**: Use `["en"]` only. (Filters out lower-intent local traffic).
        *   **Chinese-Speaking Niche**: Use `["en", "zh"]`.
    *   **Location**:
        *   **Location Consolidation & Strictness**:
            *   **Consolidation**: If the Business Context lists multiple distinct branches (e.g., KL, Penang, Johor), generate a single campaign. Populate `Location.Included` with all valid target cities and `Location.Excluded` with irrelevant regions (e.g., "East Malaysia" if Peninsular only).
            *   **TargetingMethod Logic**:
                *   Default to `PresenceOnly` for Local Services (Education, Medical, Home Services) where the user must physically visit the location. This prevents wasted budget from users in other regions merely "researching" the area.
                *   Use `PresenceOrInterest` ONLY for Tourism, Real Estate, or Nationwide E-commerce shipping.

2.  **BiddingLifecycle**:
    *   `Phase1_Launch`: Always set `StrategyType` to `MaximizeClicks`. **Context:** Calculate `MaxCPC_Cap_MYR` as **Daily Budget / 15** (aiming for ~15 clicks/day). **Constraints:** Never set below **2.00 MYR** (floor) and rarely above **12.00 MYR** (ceiling), unless the industry is extremely competitive (e.g., Legal/Finance).
    *   `Switch_Condition`: Default `Threshold` to `15` conversions.
    *   `Phase2_Scale`: Choose `TargetCPA` (efficiency) or `MaximizeConversions` (volume) based on the User's Goal.

3.  **AdSchedule**:
    *   **Context-Aware:** Customize based on the `Business Context`. Do not default to 24/7 unless it's an always-on e-commerce or emergency service.
    *   **Creative Examples:**
        *   *Retail/E-com:* Heavy up-weighting (+20%) on Evenings (19:00-23:00) & Weekends.
        *   *B2B/Professional:* Mon-Fri, 08:00-19:00. Exclude weekends.
        *   *Local Service (e.g., Plumber):* 07:00-22:00. Optional: +30% bid adj for "emergency" hours if applicable.
        *   *F&B/Dining:* Spikes for Lunch (11:00-14:00) and Dinner (17:00-21:00).
    *   **BidAdjustmentPercent:** Use creatively!
        *   Apply `+10` to `+30` for high-conversion windows.
        *   Apply `-20` to `-50` for low-intent hours (e.g., post-midnight) instead of turning off completely if traffic is cheap.

4.  **AdGroups**:
    *   **AdGroupName**: STRICT FORMAT: `[SubCategory] | [Intent - High/Mid/Low] { | Phase 2 }`.
        *   *Note:* Append `| Phase 2` only for ad groups intended for future scaling (e.g., Broad Match or Low Intent).
    *   **Geo-Segmentation**: If the `Business Context` lists distinct cities with sufficient search volume (e.g., KL vs Petaling Jaya), create separate Ad Groups for them to ensure Headline relevance.
    *   **DefaultMaxCPCMYR**: Set a baseline bid (slightly lower than the Campaign Cap).
    *   **Targeting > Keywords**:
        *   **Data-Driven Priority**: **Strongly prioritize** selecting keywords from the provided `Keywords Data` input to utilize actual volume and CPC metrics.
        *   **Fallback Logic**: If the provided data is insufficient, irrelevant, or lacks niche coverage, you may **supplement** with highly relevant keywords based on your internal knowledge to ensure campaign quality.
        *   **Selection Logic**: Look for the "sweet spot" of high relevance + decent search volume.
        *   **Match Types**: Use `Phrase` and `Exact` match for standard groups. Use `Broad` match **only** if the `AdGroupName` includes the `| Phase 2` tag.
        *   **Anti-Cannibalization**: Do not repeat the exact same keyword across multiple active groups. If a specific intent (e.g., "Fees") has its own Ad Group, ensure those terms are added as **Negative Keywords** in the Generic Ad Groups.

5.  **ResponsiveSearchAds**:
    * **Copywriting Best Practices**:
        * **Title Case**: Capitalize the first letter of each major word (e.g., "Best [Service] In [Location]").
        * **User-Centric**: Focus on the user's needs ("Get Your Quote," "Improve Your Skills") rather than just the brand.
        * **Specificity**: Avoid generic fluff (e.g., "Best Services"). Use concrete details (e.g., "Award-Winning [Feature]", "24/7 Support").
    * **Headlines**: Provide 5-10 distinct headlines.
        * *Asset Mix:* Ensure the output covers the strategy defined in the Knowledge Base (Keywords, Benefits, Social Proof, and CTAs).
    * **Descriptions**: Provide 2-4 descriptions (Max 90 chars).
        * *Structure:* Ensure distinct anglesâ€”one focusing on the **Value Proposition/Solution**, and another focusing on a strong **Call to Action**.

6.  **NegativeKeywords**:
    *   **Dirty Data Cleaning:** Actively scan the Keywords Data input for high-volume but irrelevant terms (e.g., "Instagram", "Login", "University", "Church", "Jobs") and add them here.
    *   **Strategic Exclusion:** Exclude keywords that technically fit the category but misalign with the Business Context USP (e.g., if the school is "Play-Based," negate "Montessori" to avoid high bounce rates from rigid intent).
    *   **Generic Negatives:** Include standard performance negatives (free, cheap, diy, salary, resume).

---

## Optimization Playbook Logic

This acts as a simple, high-impact manual for a non-expert user to manage the account.

### 1. Benchmarks (CPL)
* **Target_CPL_MYR**: If historical data is available, use the account's last 30-day average. If not, use Formula: `Estimated CPC / 0.03` (assuming 3% CVR).
* **Max_CPL_Ceiling_MYR**: Set this to **2x** the Target CPL. This is the "danger zone."

### 2. Rules of Engagement (Writing Style)
* **Tone**: Use simple, direct English. No jargon.
* **Frequency**: Map specific rules to specific days (e.g., Budget checks = Weekly; Search Terms = Bi-weekly).
* **Context**: All decisions must be based on **"Last 30 Days"** data unless specified otherwise.

### 3. Required Scenarios to Cover
Generate recommendations based on these 5 logic gates:

1.  **The "Search Term Hygiene" Rule (Negative Keywords)**
    * *Goal:* Prevent wasted spend.
    * *Trigger:* Search terms with > 50 impressions and < 1% CTR, or clearly irrelevant intent.
    * *Action:* Add as Negative Keyword.

2.  **The "Stop Loss" Rule (Pausing Bleeders)**
    * *Trigger:* Keyword spends > 1.5x Target CPL with 0 conversions **AND** has at least 10 clicks.
    * *Action:* Pause the keyword.

3.  **The "Winner's Circle" Rule (Scaling Up)**
    * *Trigger:* CPA is < Target CPL **AND** Search Lost IS (Budget) > 10%.
    * *Action:* Increase daily budget by 10-20%.

4.  **The "Ad Copy Refresh" Rule (CTR & Quality Score)**
    * *Trigger:* Ad CTR < 2% (Search) OR Ad Relevance is "Below Average."
    * *Action:* Rewrite headlines to include the main keyword.

5.  **The "Quality Score Boost" Rule (Long-Term Health)**
    * *Trigger:* Quality Score < 5/10 for keywords spending > 20% of budget.
    * *Action:* Improve Landing Page speed or ensure keyword appears in H1 tag.

**Output the JSON now:**